# 仕様（現状 / MVP）

このドキュメントは「今の実装」の仕様をまとめたものです。
（方針: iPhone Safari 最優先 / 片手操作 / 短時間入力 / MVP範囲外の分析やSNSは扱わない）

## 1. アプリ概要
- 種目（ユーザー専用マスタ）を登録し、日付ごとにワークアウトを作成して「重量・回数」を記録する
- テンプレ（よくあるメニュー）を作成して、ワークアウトに適用できる
- 種目ごとの履歴・軌跡（伸び）を見られる

## 2. 動作モード
### 2.1 Supabase モード（本番想定）
- Next.js（App Router）+ Supabase（Auth + Postgres）
- RLS によりユーザーごと完全分離
- DB設計の正は supabase/schema.sql

### 2.2 ローカルモード（UI調整用）
- 環境変数: NEXT_PUBLIC_GYMAPP_LOCAL_ONLY=1
- Supabase無しで動作（ログイン不要）
- データ保存先: .localdb.json（リポジトリ直下 / gitignore対象）

## 3. データモデル（概念）
- exercises: 種目マスタ（ユーザーごと）
  - name（重複不可: user_id + lower(name)）
  - target_parts（胸/背中/肩/腕/脚/腹 の配列）
- workouts: その日のワークアウト（同一日複数可）
- workout_exercises: 1ワークアウトに含めた種目（並び順あり）
- exercise_sets: 1種目のセット（set_order、weight、reps）
- workout_templates / workout_template_exercises / workout_template_sets: テンプレ（ユーザーごと）
- user_settings: ジムログインURLなど

## 4. 画面/ルーティング
### 4.1 カレンダー（/）
- 月カレンダー
  - 週の並びは「月〜日」
  - 記録がある日をマーク
  - 今日を強調
- 今月サマリー
  - トレ日数
  - 総セット数
  - 部位別セット数
- 「＋ 今日の記録」
  - 今日の日付でワークアウトを作成し、ワークアウト編集へ遷移

### 4.2 日付ページ（/day/[date]）
- その日のワークアウト一覧（同日複数ワークアウト可）
- 一覧上で「種目名」と「セット概要（例: 60kg×10）」を短く表示
- 「この日のワークアウトを作成」ボタン

### 4.3 ワークアウト編集（/workouts/[id]）
- 日付・メモはオートセーブ
- 種目追加
  - 部位別グループ表示
  - 検索（部分一致）で絞り込み可能
- 種目ブロック
  - 前回のトップセット（前回：60kg×10 など）を表示
  - セット行（重量/回数）を編集
  - ボタン:
    - 前回コピー（直近の同種目セットを複製）
    - セット＋（直前セットの重量/回数を複製して追加）
    - 種目削除
- 画面上部に戻る導線
  - カレンダーへ戻る
  - この日へ

### 4.4 種目管理（/exercises, /exercises/[id]）
- 種目の追加/編集/削除
- 部位タグ（複数選択）
- 種目一覧は部位別セクション
- 種目別の履歴（日時、各セット）

### 4.5 テンプレ（/templates, /templates/new）
- /templates/new
  - 新規テンプレ作成
- /templates
  - 既存テンプレ編集
  - テンプレから「今日のワークアウトを作成」（作成→テンプレ適用→ワークアウト編集へ遷移）
- テンプレ編集/作成のUI
  - 種目追加（部位別 + 検索）
  - セット編集（weight/reps）

### 4.6 軌跡（/progress）
- 種目を選択（部位別 + 検索）
- 種目の伸びをグラフで表示
  - 表示点は「2週間ごと」の代表（その期間のベストセット）
  - ベストセット判定: 重量が高い → 同重量なら回数が多い
- 履歴リストから該当ワークアウトへ遷移

### 4.7 設定（/settings）
- ジムログインURLを保存
- 設定するとヘッダーに「🏋️ ジム」ボタンが表示され、外部URLを開く

## 5. UX/入力（iPhone最優先）
- 主要な操作は「短時間で完了」することを優先
- ボタン/リンクに押下フィードバック（activeの縮み＋色変化）
- セット入力
  - inputMode（numeric/decimal）
  - ±ボタン（+2.5kg/-2.5kg、+1回/-1回）
  - 長押しで連続増減
  - 入力はオートセーブ

## 6. 初期データ（種目プリセット）
- 初回/不足時にプリセット種目のseedを行い、ユーザーの種目一覧に追加できる
- 既存ユーザーでも不足分を補完する（重複は追加しない）

## 7. 非対象（MVP範囲外）
- 体重/体脂肪の長期分析
- SNS共有/ランキング
- 複雑な集計（週次/部位別の詳細分析など）
- パーソナルな推定（1RMなど）
